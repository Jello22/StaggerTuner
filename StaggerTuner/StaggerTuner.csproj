<Project Sdk="Microsoft.NET.Sdk">

	<!-- ===== Project settings ===== -->
	<PropertyGroup>
		<TargetFramework>net48</TargetFramework>
		<AssemblyName>StaggerTuner</AssemblyName>
		<RootNamespace>VH.StaggerTuner</RootNamespace>
		<LangVersion>latest</LangVersion>
		<Optimize>true</Optimize>
		<Deterministic>true</Deterministic>
		<!-- Keep false if you have Properties/AssemblyInfo.cs -->
		<GenerateAssemblyInfo>false</GenerateAssemblyInfo>
	</PropertyGroup>

	<!-- ===== Paths: edit these two only ===== -->
	<PropertyGroup>
		<!-- Your Valheim install root -->
		<GameRoot>C:\Program Files (x86)\Steam\steamapps\common\Valheim</GameRoot>
		<!-- Where ServerSync.dll actually lives (NOT the game folder) -->
		<ServerSyncRoot>C:\git\libs</ServerSyncRoot>

		<!-- Derived: do not edit -->
		<BepInExCore>$(GameRoot)\BepInEx\core</BepInExCore>
		<UnityManaged>$(GameRoot)\valheim_Data\Managed</UnityManaged>
	</PropertyGroup>

	<!-- ===== NuGet: ILRepack MSBuild task ===== -->
	<ItemGroup>
		<PackageReference Include="ILRepack.MSBuild.Task" Version="2.0.13" PrivateAssets="all" />
	</ItemGroup>

	<!-- ===== Compile-time references =====
       BepInEx/Harmony/Unity/Valheim = resolve only (do NOT copy/merge)
       ServerSync = copy so ILRepack can merge it -->
	<ItemGroup>
		<!-- BepInEx + Harmony -->
		<Reference Include="BepInEx">
			<HintPath>$(BepInExCore)\BepInEx.dll</HintPath>
			<Private>false</Private>
		</Reference>
		<Reference Include="0Harmony">
			<HintPath>$(BepInExCore)\0Harmony.dll</HintPath>
			<Private>false</Private>
		</Reference>

		<!-- Valheim / Unity -->
		<Reference Include="assembly_valheim">
			<HintPath>$(UnityManaged)\assembly_valheim.dll</HintPath>
			<Private>false</Private>
		</Reference>
		<Reference Include="UnityEngine">
		  <HintPath>..\..\..\Program Files (x86)\Steam\steamapps\common\Valheim\valheim_Data\Managed\UnityEngine.dll</HintPath>
		  <Private>False</Private>
		</Reference>
		<Reference Include="UnityEngine.CoreModule">
			<HintPath>$(UnityManaged)\UnityEngine.CoreModule.dll</HintPath>
			<Private>false</Private>
		</Reference>
		<!-- (Optional) Only if you actually need it:
    <Reference Include="UnityEngine">
      <HintPath>$(UnityManaged)\UnityEngine.dll</HintPath>
      <Private>false</Private>
    </Reference>
    -->

		<!-- ServerSync (copy to bin so ILRepack can merge it) -->
		<Reference Include="ServerSync">
			<HintPath>$(ServerSyncRoot)\ServerSync.dll</HintPath>
			<Private>True</Private>
			<EmbedInteropTypes>False</EmbedInteropTypes>
		</Reference>
	</ItemGroup>

	<!-- ===== ILRepack merge step (Option A expects ServerSync.dll next to your DLL) ===== -->
	<!-- Keep ILRepack.targets next to this csproj; it should merge $(TargetPath) + $(OutputPath)\ServerSync.dll -->
	<Import Project="ILRepack.targets" Condition="Exists('ILRepack.targets')" />
	<ItemGroup>
	  <Reference Update="System">
	    <Private>False</Private>
	  </Reference>
	</ItemGroup>

</Project>
